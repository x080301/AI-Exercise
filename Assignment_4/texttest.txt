count_member_with_Xb(4,[(4,2),(2,1),(0,0)],Number_members).


count_in_contrains(0,1,2,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],Number_possible_value_pairs).

count_in_contrains(0,2,1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],Number_possible_value_pairs).

count_in_contrains(2,1,3,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],Number_possible_value_pairs).


count_possible_value_pairs(2,2,1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[none,none,2,none],Number_possible_value_pairs).


count_possible_value_pairs(1,2,1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[none,none,2,none],Number_possible_value_pairs).

count_possible_value_pairs(0,1,1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[none,none,2,none],Number_possible_value_pairs).

count_possible_value_pairs(0,1,1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[0,none,none,none],Number_possible_value_pairs).


get_cv_list([0,1,2,3],2,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[0,none,none,none],List_cv).


order_cv_list([1,2,3,3,3,4,1,0],Ordered_lcv_value).

lCv([4,4,4,4],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])  
],[none,V,2,none],1).


generate_list(3,1,1000,[none,none,2,none],Vsout).


calculate_rv([0,1,2,3],2,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])]
,[none,none,2,none],Rv).

calculate_rv([0,1,2,3],2,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])]
,[none,none,3,none],Rv).

consistent([
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],[none,0,2,none]).


get_mrv([4,4,4,4],1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])]
,[none,0,2,none],-1,Mrv,Listout).

get_mrv([4,4,4,4],1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])]
,[1,3,none,none],-1,Mrv,Listout).


caculate_degree([
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],2,Degree).

caculate_degree([
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],1,Degree).



count([1,2,3,4,1,1],Num).


get_degree([0,0,0,1],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],
1,Maxdegree,Maxid).

get_degree([0,0,1,0],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],
1,Maxdegree,Maxid).


get_degree([0,0,1,0],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],
1,Maxdegree,Maxid).

get_degree([0,0,1,1],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],
1,Maxdegree,Maxid).


set_new_state([none,none,2,none],2


mrv([4,4,4,4],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],[none,none,2,none],State2).


get_mrv([4,4,4,4],1,[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],[none,none,2,none],10000,_,Listout).


test(Ds,Cs,Vs):-mrv(Ds,Cs,[none,none,2,none],Vs),lCv(Ds,Cs,Vs).

test([4,4,4,4],[
  constraint(1,2, [(0,2),(0,3),(1,3),(2,0),(3,0),(3,1)]),
  constraint(1,3, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(1,4, [(0,1),(0,2), (1,0), (1,2), (1,3), (2,0), (2,1), (2,3), (3,1), (3,2)]),
  constraint(2,3, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)]),
  constraint(2,4, [(0,1),(0,3), (1,0), (1,2), (2,1), (2,3), (3,0), (3,2)]),
  constraint(3,4, [(0,2),(0,3), (1,3), (2,0), (3,0), (3,1)])],Vs).


queensDomains(Ds),queensConstraints(Cs),loops(Ds,Cs,[none, 3, none, none],Vs).

queensDomains(Ds),queensConstraints(Cs),mrv(Ds,Cs,[none, 3, none, none],Vs).


queensDomains(Ds),queensConstraints(Cs),mrv(Ds,Cs,[none, 3, 1, none],Vs).


put([1,2,3,none,2],5,4,Out).

queensConstraints(Cs),caculate_cv_in_Xs(Cs,[0,1,2,3],[none,3,1,none],4,Num).


queensDomains(Ds),queensConstraints(Cs),caculate_cv_in_Vs(Cs,Ds,[none,3,1,none],Num).

queensDomains(Ds),queensConstraints(Cs),get_cv_list(Cs,Ds,[0,1,2,3],[none,3,N,none],3,List_out).


order_cv_list([1,3,2,0,0],Ordered_lcv).

queensDomains(Ds),queensConstraints(Cs),lCv(Cs,Ds,[none,3,V,none]).

test(Vs).

queensDomains(Ds),queensConstraints(Cs),mrv(Ds,Cs,[none,none,2,none],State2).